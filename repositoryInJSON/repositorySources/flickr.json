{"meta_metadata_repository":{"name":"flickr", "package":"ecologylab.semantics.generated.library.flickr", "selector":[{"name":"flickr_search_selector", "pref_name":"flickr_search_type", "default_pref":"flickr_search_two", "url_stripped":"http://www.flickr.com/search/", "simpl.id":"76543183"},{"name":"flickr_image_detail_selector", "pref_name":"flickr_detail_type", "default_pref":"flickr_image_detail", "url_regex":"http://www.flickr.com/photos/(?!tags)[A-z0-9_@-]+/[0-9]+/$", "domain":"flickr.com", "simpl.id":"118572128"},{"name":"flickr_nearby_selector", "pref_name":"flickr_nearby_type", "default_pref":"flickr_nearby", "url_regex":"^http://www.flickr.com/photos/[A-z0-9_@-]+/[0-9]+/nearby", "domain":"flickr.com", "simpl.id":"2124414527"}], "meta_metadata":[{"name":"flickr_tag", "extends":"metadata", "visibility":"GLOBAL", "kids":[{"scalar":{"name":"tag_name", "navigates_to":"tag_link", "scalar_type":"String", "as_composite_scalar":"true"}},{"scalar":{"name":"tag_link", "hide":"true", "scalar_type":"ParsedURL"}}]},{"name":"flickr_search", "comment":"The flickr search class", "extends":"compound_document", "parser":"xpath", "visibility":"GLOBAL", "selector":[{"name":"flickr_search_selector"}]},{"name":"flickr_image_detail", "comment":"A Flickr Image result page", "extends":"compound_document", "parser":"xpath", "visibility":"GLOBAL", "kids":[{"scalar":{"name":"title", "xpath":"./h1", "context_node":"photoTD"}},{"scalar":{"name":"description", "xpath":"./div[@class=&#39;photo-desc&#39;]", "context_node":"photoTD", "ignore_in_term_vector":"true"}},{"scalar":{"name":"thumbnail_kludge", "hide":"true", "scalar_type":"ParsedURL"}},{"scalar":{"name":"image_kludge", "hide":"true", "scalar_type":"ParsedURL"}},{"collection":{"name":"flickr_tags", "xpath":"//a[@class=&#39;tag-item ywa-track&#39;]", "child_type":"flickr_tag", "kids":[{"":{"name":"flickr_tag", "type":"flickr_tag", "kids":[{"scalar":{"name":"tag_link", "xpath":"./@href", "filter":{"regex":"/photos/[^/]+/", "replace":"/photos/"}}},{"scalar":{"name":"tag_name", "xpath":"."}}]}}]}}], "def_var":[{"name":"photoTD", "xpath":"//div[@id=&#39;meta&#39;]", "type":"node"}], "selector":[{"simpl.ref":"118572128"}], "semantic_actions":[{"get_field":{"name":"title"}},{"get_field":{"name":"image_kludge"}},{"create_and_visualize_img_surrogate":{"name":"imgSurrogate", "arg":[{"name":"caption", "value":"title"},{"name":"image_purl", "value":"image_kludge"}]}},{"get_field":{"name":"flickr_tags"}},{"for_each":{"collection":"flickr_tags", "as":"tag", "nested_semantic_action_list":[{"get_field":{"object":"tag", "name":"tag_link"}},{"get_field":{"object":"tag", "name":"tag_name"}},{"parse_document":{"link_type":"OTHER_SEMANTIC_ACTION", "number_of_top_documents":"1", "arg":[{"name":"anchor_text", "value":"tag_name"},{"name":"location", "value":"tag_link"}]}}]}}]},{"name":"flickr_link", "extends":"metadata", "visibility":"GLOBAL", "kids":[{"scalar":{"name":"link", "comment":"flickr_image_detail", "hide":"true", "scalar_type":"ParsedURL"}},{"scalar":{"name":"title", "comment":"flickr_image_detail", "navigates_to":"link", "scalar_type":"String"}}]},{"name":"flickr_author", "comment":"All flickr photos of a particular user", "extends":"compound_document", "parser":"xpath", "visibility":"GLOBAL", "kids":[{"collection":{"name":"flickr_link_set", "comment":"Collection of all images of a user", "xpath":"//div[@class=&#39;Photo&#39;]", "child_type":"flickr_link", "kids":[{"":{"name":"flickr_link", "type":"flickr_link", "kids":[{"scalar":{"name":"title", "xpath":"./span/a/@title", "filter":{"regex":"by \w*", "replace":""}}},{"scalar":{"name":"link", "xpath":"./span/a/@href"}}]}}]}}], "selector":[{"url_regex":"http://www.flickr.com/photos/(?!tags)[A-z0-9_@-]+/$", "domain":"flickr.com"}], "semantic_actions":[{"get_field":{"name":"flickr_link_set"}},{"for_each":{"collection":"flickr_link_set", "as":"result", "nested_semantic_action_list":[{"get_field":{"object":"result", "name":"link"}},{"get_field":{"object":"result", "name":"title"}},{"parse_document":{"now":"true", "link_type":"OTHER_SEMANTIC_ACTION", "number_of_top_documents":"1", "arg":[{"name":"anchor_text", "value":"title"},{"name":"location", "value":"link"}]}}]}}]},{"name":"flickr_tags_interesting", "comment":"Used for flickr search results", "extends":"search", "parser":"xpath", "visibility":"GLOBAL", "kids":[{"collection":{"name":"flickr_link_set", "comment":"Collection of all images of a user", "xpath":"//span[@class=&#39;photo_container pc_t&#39;]", "child_type":"flickr_link", "kids":[{"":{"name":"flickr_link", "type":"flickr_link", "kids":[{"scalar":{"name":"link", "xpath":"./a/@href"}}]}}]}}], "selector":[{"url_regex":"http://www.flickr.com/photos/tags/[a-z0-9]+/interesting/*$", "domain":"flickr.com"}], "semantic_actions":[{"get_field":{"name":"flickr_link_set"}},{"for_each":{"collection":"flickr_link_set", "as":"result", "nested_semantic_action_list":[{"get_field":{"object":"result", "name":"link"}},{"parse_document":{"now":"true", "link_type":"OTHER_SEMANTIC_ACTION", "number_of_top_documents":"1", "arg":[{"name":"location", "value":"link"}]}}]}}]},{"name":"flickr_tags", "comment":"For flickr crawled tags", "extends":"compound_document", "parser":"xpath", "visibility":"GLOBAL", "kids":[{"collection":{"name":"flickr_link_set", "comment":"Collection of all images of a user", "xpath":"//span[@class=&#39;photo_container pc_t&#39;]", "child_type":"flickr_link", "kids":[{"":{"name":"flickr_link", "type":"flickr_link", "kids":[{"scalar":{"name":"link", "xpath":"./a/@href"}}]}}]}}], "selector":[{"url_regex":"http://www.flickr.com/photos/tags/[a-z0-9]+/*$", "domain":"flickr.com"}], "semantic_actions":[{"get_field":{"name":"flickr_link_set"}},{"for_each":{"collection":"flickr_link_set", "as":"result", "nested_semantic_action_list":[{"get_field":{"object":"result", "name":"link"}},{"parse_document":{"now":"true", "link_type":"OTHER_SEMANTIC_ACTION", "number_of_top_documents":"1", "arg":[{"name":"location", "value":"link"}]}}]}}]},{"name":"flickr_search_two", "comment":"The flickr search class", "extends":"compound_document", "parser":"xpath", "visibility":"GLOBAL", "kids":[{"collection":{"name":"flickr_results", "xpath":"//div[@class=&#39;DetailResults&#39;]//div[@class=&#39;box&#39;]", "child_type":"flickr_image_detail", "kids":[{"":{"name":"flickr_image_detail", "type":"flickr_image_detail", "kids":[{"scalar":{"name":"title", "xpath":".//h3[@class=&#39;PicTitle&#39;]"}},{"scalar":{"name":"thumbnail_kludge", "xpath":".//span//img/@src"}},{"scalar":{"name":"location", "xpath":".//span//a/@href"}},{"collection":{"name":"flickr_tags", "xpath":".//div[@class=&#39;ListThings&#39;]//a[starts-with(@href,&#39;/photos/tag&#39;)]", "child_type":"flickr_tag", "kids":[{"":{"name":"flickr_tag", "type":"flickr_tag", "kids":[{"scalar":{"name":"tag_link", "xpath":"./@href", "filter":{"regex":"/clusters/", "replace":""}}},{"scalar":{"name":"tag_name", "xpath":"."}}]}}]}}]}}]}}], "selector":[{"simpl.ref":"76543183"}], "semantic_actions":[{"get_field":{"name":"flickr_results"}},{"for_each":{"collection":"flickr_results", "as":"result", "nested_semantic_action_list":[{"get_field":{"object":"result", "name":"title"}},{"get_field":{"object":"result", "name":"thumbnail_kludge"}},{"create_and_visualize_img_surrogate":{"name":"imgSurrogate", "arg":[{"name":"caption", "value":"title"},{"name":"image_purl", "value":"thumbnail_kludge"},{"name":"source_document", "value":"result"}]}},{"parse_document":{"link_type":"OTHER_SEMANTIC_ACTION", "number_of_top_documents":"1", "arg":[{"name":"result", "value":"document"}]}},{"get_field":{"object":"result", "name":"flickr_tags"}},{"for_each":{"collection":"flickr_tags", "as":"tag", "nested_semantic_action_list":[{"get_field":{"object":"tag", "name":"tag_link"}},{"get_field":{"object":"tag", "name":"tag_name"}},{"parse_document":{"link_type":"OTHER_SEMANTIC_ACTION", "number_of_top_documents":"1", "arg":[{"name":"anchor_text", "value":"tag_name"},{"name":"location", "value":"tag_link"},{"name":"source_document", "value":"result"}]}}]}}]}}]},{"name":"author_photos", "extends":"metadata", "visibility":"GLOBAL", "kids":[{"scalar":{"name":"author_photostream_link", "hide":"true", "scalar_type":"ParsedURL"}},{"scalar":{"name":"author_photostream", "navigates_to":"author_photostream_link", "scalar_type":"String"}},{"scalar":{"name":"photos_that_day_link", "hide":"true", "scalar_type":"ParsedURL"}},{"scalar":{"name":"photos_that_month_link", "hide":"true", "scalar_type":"ParsedURL"}},{"scalar":{"name":"photos_that_year_link", "hide":"true", "scalar_type":"ParsedURL"}},{"scalar":{"name":"photos_that_day", "navigates_to":"photos_that_day_link", "scalar_type":"String"}},{"scalar":{"name":"photos_that_month", "navigates_to":"photos_that_month_link", "scalar_type":"String"}},{"scalar":{"name":"photos_that_year", "navigates_to":"photos_that_year_link", "scalar_type":"String"}}]},{"name":"flickr_image_detail_two", "comment":"A Flickr Image result page", "extends":"compound_document", "parser":"xpath", "visibility":"GLOBAL", "kids":[{"scalar":{"name":"title", "xpath":"./h1", "context_node":"photoTD"}},{"scalar":{"name":"description", "xpath":"./div[@class=&#39;photo-desc&#39;]", "context_node":"photoTD", "ignore_in_term_vector":"true"}},{"scalar":{"name":"views", "xpath":"//span[@id=&#39;view-count&#39;]", "scalar_type":"String", "filter":{"regex":" views$", "replace":""}}},{"scalar":{"name":"place", "xpath":".//a[@id=&#39;photoGeolocation-storylink&#39;]", "navigates_to":"place_link", "scalar_type":"String"}},{"scalar":{"name":"place_link", "xpath":"//html/head/link[2]/@href", "hide":"true", "scalar_type":"ParsedURL", "filter":{"regex":"$", "replace":"nearby?show=thumb&amp;fromfilter=1&amp;by=everyone&amp;taken=alltime&amp;sort=distance&amp;show=detail"}}},{"collection":{"name":"flickr_tags", "xpath":"//a[@class=&#39;tag-item ywa-track&#39;]", "promote_children":"true", "child_type":"flickr_tag", "kids":[{"":{"name":"flickr_tag", "promote_children":"true", "type":"flickr_tag", "kids":[{"scalar":{"name":"tag_link", "xpath":"./@href"}},{"scalar":{"name":"tag_name", "xpath":"."}}]}}]}},{"composite":{"name":"author_photos", "xpath":"//div[@id=&#39;photo-story&#39;]", "type":"author_photos", "kids":[{"scalar":{"name":"author_photostream_link", "xpath":"./p[@id=&#39;photo-story-story&#39;]/a[1]/@href", "ignore_in_term_vector":"true", "filter":{"regex":"archives/date-taken/[0-9]+/[0-9]+/[0-9]+/$", "replace":""}}},{"scalar":{"name":"author_photostream", "xpath":".//div[@id=&#39;photo-story-attribution&#39;]/p/span/a/@href", "filter":{"regex":"/photos", "replace":""}}},{"scalar":{"name":"photos_that_day_link", "xpath":"./p[@id=&#39;photo-story-story&#39;]/a[1]/@href", "ignore_in_term_vector":"true"}},{"scalar":{"name":"photos_that_month_link", "xpath":"./p[@id=&#39;photo-story-story&#39;]/a[1]/@href", "ignore_in_term_vector":"true", "filter":{"regex":"[0-9]+/$", "replace":""}}},{"scalar":{"name":"photos_that_year_link", "xpath":"./p[@id=&#39;photo-story-story&#39;]/a[1]/@href", "ignore_in_term_vector":"true", "filter":{"regex":"[0-9]+/[0-9]+/$", "replace":""}}},{"scalar":{"name":"photos_that_day", "xpath":"./p[@id=&#39;photo-story-story&#39;]/a[1]", "ignore_in_term_vector":"true"}},{"scalar":{"name":"photos_that_month", "xpath":"./p[@id=&#39;photo-story-story&#39;]/a[1]", "ignore_in_term_vector":"true", "filter":{"regex":"[0-9]+,", "replace":""}}},{"scalar":{"name":"photos_that_year", "xpath":"./p[@id=&#39;photo-story-story&#39;]/a[1]", "ignore_in_term_vector":"true", "filter":{"regex":"\w+ [0-9]+,", "replace":""}}}]}}], "def_var":[{"name":"photoTD", "xpath":"//div[@id=&#39;meta&#39;]", "type":"node"}], "selector":[{"name":"flickr_image_detail_selector"}]},{"name":"flickr_nearby", "comment":"Searching from a photo for nearby photos", "type":"search", "parser":"xpath", "visibility":"GLOBAL", "kids":[{"collection":{"name":"search_results", "xpath":"//span[@class=&#39;photo_container pc_m&#39;]", "kids":[{"":{"name":"&amp;UNRESOLVED_NAME", "kids":[{"scalar":{"name":"link_other", "xpath":"./a/@href", "filter":{"regex":"nearby.+detail$", "replace":""}}},{"scalar":{"name":"link", "xpath":"./a/@href", "filter":{"regex":"nearby.+detail$", "replace":"nearby?show=thumb&amp;fromfilter=1&amp;by=everyone&amp;taken=alltime&amp;sort=distance&amp;show=detail"}}},{"scalar":{"name":"snippet", "xpath":"./a/@title"}},{"scalar":{"name":"heading", "xpath":"./a"}}]}}]}}], "selector":[{"simpl.ref":"2124414527"}], "semantic_actions":[{"get_field":{"name":"search_results"}},{"for_each":{"collection":"search_results", "as":"res", "nested_semantic_action_list":[{"get_field":{"object":"res", "name":"link"}},{"parse_document":{"now":"true", "link_type":"OTHER_SEMANTIC_ACTION", "number_of_top_documents":"1", "arg":[{"name":"location", "value":"link"}]}},{"get_field":{"object":"res", "name":"link_other"}},{"parse_document":{"now":"true", "link_type":"OTHER_SEMANTIC_ACTION", "number_of_top_documents":"1", "arg":[{"name":"location", "value":"link_other"}]}}]}}]},{"name":"flickr_groups", "comment":"Searching from a photo for nearby photos", "extends":"search", "parser":"xpath", "visibility":"GLOBAL", "kids":[{"collection":{"name":"flickr_tags", "xpath":"//div[@class=&#39;Paginator&#39;]/a/@href", "hide":"true", "child_type":"flickr_tag", "kids":[{"":{"name":"flickr_tag", "type":"flickr_tag", "kids":[{"scalar":{"name":"tag_link", "xpath":"."}},{"scalar":{"name":"tag_name", "xpath":"."}}]}}]}},{"collection":{"name":"search_results", "xpath":"//p[@class=&#39;PoolList&#39;]", "kids":[{"":{"name":"&amp;UNRESOLVED_NAME", "kids":[{"scalar":{"name":"link", "xpath":"./span/a/@href", "filter":{"regex":"/in/.*$", "replace":"/"}}},{"scalar":{"name":"snippet", "xpath":"./span/a/@title"}},{"scalar":{"name":"heading", "xpath":"./span/a"}}]}}]}}], "selector":[{"url_regex":"^http://www.flickr.com/groups/[A-z0-9_@-]+/pool", "domain":"flickr.com"}], "semantic_actions":[{"get_field":{"name":"search_results"}},{"for_each":{"collection":"search_results", "as":"res", "nested_semantic_action_list":[{"get_field":{"object":"res", "name":"link"}},{"parse_document":{"now":"true", "link_type":"OTHER_SEMANTIC_ACTION", "number_of_top_documents":"1", "arg":[{"name":"location", "value":"link"}]}}]}},{"get_field":{"name":"flickr_tags"}},{"for_each":{"collection":"flickr_tags", "as":"res", "nested_semantic_action_list":[{"get_field":{"object":"res", "name":"tag_link"}},{"parse_document":{"now":"true", "link_type":"OTHER_SEMANTIC_ACTION", "number_of_top_documents":"1", "arg":[{"name":"location", "value":"tag_link"}]}}]}}]}]}}