
<meta_metadata_repository name="default" package="ecologylab.semantics.generated.library.icdl">
	<meta_metadata name="icdl" extends="document" comment="The ICDL class" 
			package="ecologylab.semantics.generated.library.icdl" parser="direct">
		<selector url_stripped="http://www.childrenslibrary.org/BookXMLResults?"/>
		<!-- 
		For safety we'd like to add additional selectors:
		<selector>
			<mime_type>xml/rss</mime_type>
			<mime_type>application/rss</mime_type>
		</selector>
		 -->
		<composite name="response" >
			<scalar name="pnum" scalar_type="Int"/>
			<scalar name="total" scalar_type="Int"/>
			<collection name="books" no_wrap="true" child_type="book">
				<scalar name="id" scalar_type="Int"/>
				<scalar name="booktitle" scalar_type="String"/>
				<scalar name="languages" scalar_type="String"/>
				<scalar name="cover" scalar_type="ParsedURL"/>
				<scalar name="width" scalar_type="Int"/>
				<scalar name="height" scalar_type="Int"/>
				<scalar name="bookurl" scalar_type="ParsedURL"/>
			</collection>
		</composite>
		<semantic_actions>
			<get_field name="books" object="response"/>
			<if>
				<not_null value="books"/>
				<for_each collection="books" as="book">
					<get_field name="cover" object="book"/>
					<get_field name="bookurl" object="book"/>
					<get_field name="booktitle" object="book"/>
					<get_field name="width" object="book"/>
					<get_field name="height" object="book"/>
					<create_and_visualize_img_surrogate name="cover_page_surrogate">
						<arg value="cover" name="image_purl"/>
						<arg value="bookurl" name="href"/>
						<arg value="booktitle" name="caption"/>
						<arg value="width" name="width" />
						<arg value="height" name="height"/>
					</create_and_visualize_img_surrogate>
				</for_each>
			</if>
		</semantic_actions>
	</meta_metadata>
</meta_metadata_repository>